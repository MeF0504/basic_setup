#! /usr/bin/env python3
# vim: set filetype=python:

from __future__ import print_function

import os
import argparse

import h5py

#function to show the constitution of hdf5 file.
def print_data(name, obj):
    if isinstance(obj, h5py.Dataset):
        print(name)
        if args.verbose:
            with h5py.File(args.file, 'r') as f:
                print(" >>>  {}".format(f[name][()]))

def main(args):

    fpath = os.path.expanduser(args.file)
    if not os.path.exists(fpath):
        print("file doesn't exists!")
        return

    with h5py.File(fpath, 'r') as f:
        # https://qiita.com/skotaro/items/873507dc8f8f967bbc03
        f.visititems(print_data)

    return

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="show the constitution of hdf5 file.")
    parser.add_argument('file', help='imput hdf5 file')
    parser.add_argument('-v', dest='verbose', action='store_true', help='show details')
    args = parser.parse_args()

    main(args)
