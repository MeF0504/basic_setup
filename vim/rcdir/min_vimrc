"vim script encording setting
set encoding=utf-8
set fileencoding=utf-8
scriptencoding utf-8
augroup local
    autocmd!
augroup END

if has('nvim')
    let g:vimdir = expand('~/.config/nvim/')
else
    if has('win32')
        let g:vimdir = expand('~/vimfiles/')
    else
        let g:vimdir = expand('~/.vim/')
    endif
endif

""##########basic_setup "{{{
set number
set laststatus=2
set ruler
set cmdheight=2
set wrap
set notitle
set nocompatible
set tabstop=4
set autoindent
set shiftwidth=4
syntax enable
set hlsearch
set showcmd
set backspace=start,indent
"set backspace=start,eol,indent
set mouse=i
"set mouse=a
set expandtab
set softtabstop=4
set ignorecase
set smartcase
"set list
set listchars=tab:».,trail:~,extends:»,precedes:«,nbsp:% ",eol:↲
set noincsearch
set scrolloff=2
set wildmenu
set wildmode=longest,full
set foldenable
set foldmethod=marker
set splitright
if isdirectory(g:vimdir . 'doc')
    execute "helptags " . g:vimdir . "doc"
endif

set cursorline

set swapfile
set nobackup
set noundofile

set tags=tags;,./tags;

set grepprg=internal
autocmd local QuickFixCmdPost *grep* cwindow

set statusline=%f%m%r%h%w%<%=%y\ %l/%L\ [%P]
"}}}

""##########mapping "{{{

nnoremap ZZ <Nop>
nnoremap ZQ <Nop>
nnoremap Q <Nop>

nnoremap s <c-w>
nnoremap sj <c-w>j
nnoremap s<Down> <c-w>j
nnoremap sk <c-w>k
nnoremap s<Up> <c-w>k
nnoremap sh <c-w>h
nnoremap s<Left> <c-w>h
nnoremap sl <c-w>l
nnoremap s<Right> <c-w>l
"nnoremap T :tablast <bar> :tabnew<space>
nnoremap T :tabnew<space>
nnoremap <silent> co :botright copen<CR>
nnoremap <silent> cc :cclose<CR>
nnoremap <silent> cn :cnewer<CR>
nnoremap <silent> cp :colder<CR>
nnoremap / /\v
nnoremap * /\v<<c-r><c-w>><CR>
nnoremap g<Right> gt
nnoremap g<Left> gT
nnoremap gl gt
nnoremap gh gT
nnoremap <silent> 0gt :tablast<CR>
nnoremap <silent> g> :tabmove +1<CR>
nnoremap <silent> g< :tabmove -1<CR>
nnoremap zO zR
nnoremap zC zM
nnoremap Y y$
vnoremap Y $y
nnoremap <expr> l foldclosed(line('.')) != -1 ? 'zO' : 'l'
nnoremap <expr> <Right> foldclosed(line('.')) != -1 ? 'zO' : 'l'
nnoremap <expr> <CR> foldlevel('.') != 0 ? 'za' : '<CR>'

noremap W b
noremap gw W
noremap gW B
noremap E ge
noremap ge E

nnoremap gf <c-w>gf

autocmd local Filetype qf nnoremap <buffer><silent> <c-t> <c-w><s-t><CR>:cclose<CR>

nnoremap <c-]> g<c-]>
"
nnoremap <silent> g<c-]> :vertical stjump<CR>
nnoremap <silent> <c-l> :execute("ptjump " . expand("<cword>"))<CR>

nnoremap <silent> \ :nohlsearch<CR>

nnoremap <expr> <silent> q &previewwindow==0 ? 'q' : ':quit<CR>'

" }}}

